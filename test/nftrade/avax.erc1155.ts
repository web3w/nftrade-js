import secrets from '../../../secrets.json'
import { Asset, SellOrderParams } from 'web3-accounts'
import { NFTradeEx } from '../../src/nftradeEx'

// const buyer = '0x0A56b3317eD60dC4E1027A63ffbE9df6fb102401'
const seller = '0x6E339d654815c6d79727f1b94b77d85863eB3659'


const chainId = 43114
const sellContract = new NFTradeEx({
    chainId,
    address: seller,
    privateKeys: secrets.privateKeys
  })

;(async () => {
  try {
    const collection = {
      royaltyFeePoints: 200,
      royaltyFeeAddress: '0x8131023E40626b26d2E2F921b420f0a8Da21c972'
    }
    const sellAsset = {
      tokenId: '5',
      tokenAddress: '0x90259d1416e5aea964eac2441aa20e9fb2d99262',
      schemaName: 'ERC721',
      collection
    } as Asset

    const sellAsset1155 = {
      tokenId: '5',
      tokenAddress: '0xdad95F1Ec9360Ffd5c942592b9A5988172134a35',
      schemaName: 'ERC1155',
      collection
    } as Asset

    const quantity = 2, startAmount = 0.0002

    const sellParams1155 = {
      asset: sellAsset1155,
      quantity,
      startAmount
    } as SellOrderParams

    let sell1155bal = await sellContract.userAccount.getAssetBalances(sellAsset1155)
    console.log('Seller:', sell1155bal)
    if (sell1155bal == '0') {
      throw new Error(' sellbal and buybal 0')
    }
    if (Number(sell1155bal) > 0) {
      const signedOrder1155 = await sellContract.createSellOrder(sellParams1155)
      const calldata = await sellContract.orderMatchCallData([signedOrder1155])
      const gas = await sellContract.estimateGas(calldata)
      console.log('BuyNow Gas:', gas)
    }


  } catch (e) {
    console.log(e)
  }
})()

// const order1155 = {
//   'price': 0.02,
//   'id': '48332043-28b1-4428-93a9-8c260b1b2cb2',
//   'chainId': '43114',
//   'senderAddress': '0x0000000000000000000000000000000000000000',
//   'makerAddress': '0x36b1a29e0bbd47dfe9dcf7380f276e86da90c4c2',
//   'takerAddress': '0x0000000000000000000000000000000000000000',
//   'makerAssetData': '0xa7cb5fb7000000000000000000000000dad95f1ec9360ffd5c942592b9a5988172134a35000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000',
//   'takerAssetData': '0xf47261b0000000000000000000000000b31f66aa3c1e785363f0875a1b74e27b85fd66c7',
//   'exchangeAddress': '0xcFB6Ee27d82beb1B0f3aD501B968F01CD7Cc5961',
//   'feeRecipientAddress': '0x0000000000000000000000000000000000000000',
//   'expirationTimeSeconds': '1654378935335',
//   'makerFee': '0',
//   'takerFee': '0',
//   'makerAssetAmount': '1',
//   'takerAssetAmount': '20000000000000000',
//   'salt': '10170851613158457999890999269085286139198020801662165258601619738850289718839',
//   'signature': '0x1c399ee4106cff74c6f962df53ad04e048abfc26c6f666b9c9458eaadc038b22270ecf8b0049b1fe951004ebbfc92bdc05bfc637ee721196893b709afb08a3ee2502',
//   'makerFeeAssetData': '0xa7cb5fb7000000000000000000000000dad95f1ec9360ffd5c942592b9a5988172134a35000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000',
//   'takerFeeAssetData': '0xf47261b0000000000000000000000000b31f66aa3c1e785363f0875a1b74e27b85fd66c7',
//   'recipientAddress': null,
//   'orderHash': '0x687a309ceb0b5d16759d46fd77e2a2fcd840b145178b959834398736967f7fb0'
// }
